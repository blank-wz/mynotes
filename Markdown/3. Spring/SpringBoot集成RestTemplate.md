# 一, Http 协议 状态码解析

## 1xx Informational 通知

- [100 Continue](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-100-status-code/) 通知请求继续

![image-20220503161705369](https://raw.githubusercontent.com/blank-wz/typoraimage/main/images/2022/05/03/2238dba33b244648e29c582773f3d909-image-20220503161705369-94622b.png)

- [101 Switching Protocols](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-101-status-code/)
- [102 Processing](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-102-status-code/)

## 2×× Success 请求成功返回

- [200 OK](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-200-status-code/)
- [201 Created](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-201-status-code/)
- [202 Accepted](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-202-status-code/)
- [203 Non-authoritative Information](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-203-status-code/)
- [204 No Content](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-204-status-code/)
- [205 Reset Content](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-205-status-code/)
- [206 Partial Content](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-206-status-code/)
- [207 Multi-Status](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-207-status-code/)
- [208 Already Reported](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-208-status-code/)
- [226 IM Used](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-226-status-code/)

## 3×× Redirection 重定向

- [300 Multiple Choices](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-300-status-code/)
- [301 Moved Permanently](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-301-status-code/) 永久迁移
- [302 Found](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-302-status-code/) 临时迁移
- [303 See Other](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-303-status-code/)
- [304 Not Modified](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-304-status-code/)
- [305 Use Proxy](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-305-status-code/)
- [307 Temporary Redirect](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-307-status-code/)
- [308 Permanent Redirect](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-308-status-code/)

## 4×× Client Error 客户端异常

- [400 Bad Request](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-400-status-code/)
- [401 Unauthorized](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-401-status-code/)
- [402 Payment Required](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-402-status-code/)
- [403 Forbidden](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-403-status-code/)
- [404 Not Found](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-404-status-code/) 访问的 URL 不存在
- [405 Method Not Allowed](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-405-status-code/)
- [406 Not Acceptable](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-406-status-code/)
- [407 Proxy Authentication Required](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-407-status-code/)
- [408 Request Timeout](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-408-status-code/)
- [409 Conflict](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-409-status-code/)
- [410 Gone](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-410-status-code/)
- [411 Length Required](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-411-status-code/)
- [412 Precondition Failed](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-412-status-code/)
- [413 Payload Too Large](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-413-status-code/)
- [414 Request-URI Too Long](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-414-status-code/)
- [415 Unsupported Media Type](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-415-status-code/)
- [416 Requested Range Not Satisfiable](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-416-status-code/)
- [417 Expectation Failed](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-417-status-code/)
- [418 I’m a teapot](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-418-status-code/)
- [421 Misdirected Request](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-421-status-code/)
- [422 Unprocessable Entity](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-422-status-code/)
- [423 Locked](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-423-status-code/)
- [424 Failed Dependency](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-424-status-code/)
- [426 Upgrade Required](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-426-status-code/)
- [428 Precondition Required](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-428-status-code/)
- [429 Too Many Requests](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-429-status-code/)
- [431 Request Header Fields Too Large](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-431-status-code/)
- [444 Connection Closed Without Response](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-444-status-code/)
- [451 Unavailable For Legal Reasons](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-451-status-code/)
- [499 Client Closed Request](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-499-status-code/)

## 5×× Server Error 服务端异常

- [500 Internal Server Error](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-500-status-code/) 服务器内部错误
- [501 Not Implemented](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-501-status-code/)
- [502 Bad Gateway](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-502-status-code/)
- [503 Service Unavailable](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-503-status-code/)
- [504 Gateway Timeout](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-504-status-code/)
- [505 HTTP Version Not Supported](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-505-status-code/)
- [506 Variant Also Negotiates](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-506-status-code/)
- [507 Insufficient Storage](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-507-status-code/)
- [508 Loop Detected](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-508-status-code/)
- [510 Not Extended](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-510-status-code/)
- [511 Network Authentication Required](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-511-status-code/)
- [599 Network Connect Timeout Error](https://www.webfx.com/web-development/glossary/http-status-codes/what-is-a-599-status-code/)



# 二, SpringBoot 集成 RestTemplate



## 2.1 背景介绍

在微服务架构下都是以 HTTP 接口的形式暴露自生服务的, 因此在调用远程服务时就必须使用 HTTP 客户端. 我们可以使用 JDK 原生的 HttpURLConnection, Apache 的 HttpClient, Netty 的异步 HTTP Client, Spring 的 RestTemplate. 

RestTemplate 是一个同步的 Web Http 客户端请求模板工具, 底层默认使用 HttpURLConnection, 可以通过构造方法替换底层的执行引擎, 常见的执行引擎包括 HttpClient, Netty, OkHttp

-----

常见的 Http 客户端请求工具:

+ JDK HttpURLConnection
+ Apache HttpClient
+ OkHttp



## 2.2 RestTemplate 的使用

### 2.2.1 构造方法

| Constructor and Description                                  |
| :----------------------------------------------------------- |
| `RestTemplate()`Create a new instance of the [`RestTemplate`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/RestTemplate.html) using default settings. |
| `RestTemplate(ClientHttpRequestFactory requestFactory)`Create a new instance of the [`RestTemplate`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/RestTemplate.html) based on the given [`ClientHttpRequestFactory`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/client/ClientHttpRequestFactory.html). |
| `RestTemplate(List<HttpMessageConverter<?>> messageConverters)`Create a new instance of the [`RestTemplate`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/RestTemplate.html) using the given list of [`HttpMessageConverter`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/converter/HttpMessageConverter.html) to use. |

````java
// 性能优化
// 底层默认执行引擎 HttpUrlConnection
RestTemplate template = new RestTemplate();

// 底层执行引擎改用 Apache HttpComponents (HttpClient)
RestTemplate template = new RestTemplate(new HttpComponentsClientHttpRequestFactory());
````



### 2.2.2 方法

| 修饰符和类型                               | 方法及说明                                                   |
| :----------------------------------------- | :----------------------------------------------------------- |
| `<T> RequestCallback`                      | `acceptHeaderRequestCallback(Class<T> responseType)`返回一个 基于给定响应类型`RequestCallback`设置请求标头的 a，并与配置的消息转换器进行交叉检查。`Accept` |
| `void`                                     | `delete(String url, Map<String,?> uriVariables)`删除指定 URI 处的资源。 |
| `void`                                     | `delete(String url, Object... uriVariables)`删除指定 URI 处的资源。 |
| `void`                                     | `delete(URI url)`删除指定 URL 处的资源。                     |
| `protected <T> T`                          | `doExecute(URI url, HttpMethod method, RequestCallback requestCallback, ResponseExtractor<T> responseExtractor)`在提供的 URI 上执行给定的方法。 |
| `<T> ResponseEntity<T>`                    | `exchange(RequestEntity<?> requestEntity, Class<T> responseType)`执行给定中指定的请求[`RequestEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/RequestEntity.html)并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> ResponseEntity<T>`                    | `exchange(RequestEntity<?> requestEntity, ParameterizedTypeReference<T> responseType)`执行给定中指定的请求[`RequestEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/RequestEntity.html)并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> ResponseEntity<T>`                    | `exchange(String url, HttpMethod method, HttpEntity<?> requestEntity, Class<T> responseType, Map<String,?> uriVariables)`对给定的 URI 模板执行 HTTP 方法，将给定的请求实体写入请求，并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> ResponseEntity<T>`                    | `exchange(String url, HttpMethod method, HttpEntity<?> requestEntity, Class<T> responseType, Object... uriVariables)`对给定的 URI 模板执行 HTTP 方法，将给定的请求实体写入请求，并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> ResponseEntity<T>`                    | `exchange(String url, HttpMethod method, HttpEntity<?> requestEntity, ParameterizedTypeReference<T> responseType, Map<String,?> uriVariables)`对给定的 URI 模板执行 HTTP 方法，将给定的请求实体写入请求，并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> ResponseEntity<T>`                    | `exchange(String url, HttpMethod method, HttpEntity<?> requestEntity, ParameterizedTypeReference<T> responseType, Object... uriVariables)`对给定的 URI 模板执行 HTTP 方法，将给定的请求实体写入请求，并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> ResponseEntity<T>`                    | `exchange(URI url, HttpMethod method, HttpEntity<?> requestEntity, Class<T> responseType)`对给定的 URI 模板执行 HTTP 方法，将给定的请求实体写入请求，并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> ResponseEntity<T>`                    | `exchange(URI url, HttpMethod method, HttpEntity<?> requestEntity, ParameterizedTypeReference<T> responseType)`对给定的 URI 模板执行 HTTP 方法，将给定的请求实体写入请求，并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> T`                                    | `execute(String url, HttpMethod method, RequestCallback requestCallback, ResponseExtractor<T> responseExtractor, Map<String,?> uriVariables)`对给定的 URI 模板执行 HTTP 方法，使用 准备请求 [`RequestCallback`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/RequestCallback.html)，并使用 读取响应[`ResponseExtractor`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/ResponseExtractor.html)。 |
| `<T> T`                                    | `execute(String url, HttpMethod method, RequestCallback requestCallback, ResponseExtractor<T> responseExtractor, Object... uriVariables)`对给定的 URI 模板执行 HTTP 方法，使用 准备请求 [`RequestCallback`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/RequestCallback.html)，并使用 读取响应[`ResponseExtractor`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/ResponseExtractor.html)。 |
| `<T> T`                                    | `execute(URI url, HttpMethod method, RequestCallback requestCallback, ResponseExtractor<T> responseExtractor)`对给定的 URL 执行 HTTP 方法，使用 准备请求 [`RequestCallback`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/RequestCallback.html)，并使用 读取响应[`ResponseExtractor`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/ResponseExtractor.html)。 |
| `ResponseErrorHandler`                     | `getErrorHandler()`返回错误处理程序。                        |
| `<T> ResponseEntity<T>`                    | `getForEntity(String url, Class<T> responseType, Map<String,?> uriVariables)`通过对 URI 模板执行 GET 来检索表示。 |
| `<T> ResponseEntity<T>`                    | `getForEntity(String url, Class<T> responseType, Object... uriVariables)`通过对指定 URL 执行 GET 来检索实体。 |
| `<T> ResponseEntity<T>`                    | `getForEntity(URI url, Class<T> responseType)`通过对 URL 执行 GET 来检索表示。 |
| `<T> T`                                    | `getForObject(String url, Class<T> responseType, Map<String,?> uriVariables)`通过对 URI 模板执行 GET 来检索表示。 |
| `<T> T`                                    | `getForObject(String url, Class<T> responseType, Object... uriVariables)`通过对指定 URL 执行 GET 来检索表示。 |
| `<T> T`                                    | `getForObject(URI url, Class<T> responseType)`通过对 URL 执行 GET 来检索表示。 |
| `List<HttpMessageConverter<?>>`            | `getMessageConverters()`返回消息正文转换器的列表。           |
| `UriTemplateHandler`                       | `getUriTemplateHandler()`返回配置的 URI 模板处理程序。       |
| `protected void`                           | `handleResponse(URI url, HttpMethod method, ClientHttpResponse response)`[`ResponseErrorHandler`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/web/client/ResponseErrorHandler.html)处理给定的响应，执行适当的日志记录并在必要时调用。 |
| `protected ResponseExtractor<HttpHeaders>` | `headersExtractor()`返回 的响应提取器[`HttpHeaders`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/HttpHeaders.html)。 |
| `HttpHeaders`                              | `headForHeaders(String url, Map<String,?> uriVariables)`检索由 URI 模板指定的资源的所有标头。 |
| `HttpHeaders`                              | `headForHeaders(String url, Object... uriVariables)`检索由 URI 模板指定的资源的所有标头。 |
| `HttpHeaders`                              | `headForHeaders(URI url)`检索由 URL 指定的资源的所有标头。   |
| `<T> RequestCallback`                      | `httpEntityCallback(Object requestBody)`返回`RequestCallback`将给定对象写入请求流的实现。 |
| `<T> RequestCallback`                      | `httpEntityCallback(Object requestBody, Type responseType)`返回一个`RequestCallback`实现：`Accept`根据给定的响应类型设置请求标头，与配置的消息转换器进行交叉检查。 |
| `Set<HttpMethod>`                          | `optionsForAllow(String url, Map<String,?> uriVariables)`返回给定 URI 的 Allow 标头的值。 |
| `Set<HttpMethod>`                          | `optionsForAllow(String url, Object... uriVariables)`返回给定 URI 的 Allow 标头的值。 |
| `Set<HttpMethod>`                          | `optionsForAllow(URI url)`返回给定 URL 的 Allow 标头的值。   |
| `<T> T`                                    | `patchForObject(String url, Object request, Class<T> responseType, Map<String,?> uriVariables)`通过将给定对象修补到 URI 模板来更新资源，并返回在响应中找到的表示。 |
| `<T> T`                                    | `patchForObject(String url, Object request, Class<T> responseType, Object... uriVariables)`通过将给定对象修补到 URI 模板来更新资源，并返回在响应中找到的表示。 |
| `<T> T`                                    | `patchForObject(URI url, Object request, Class<T> responseType)`通过将给定对象修补到 URL 来更新资源，并返回在响应中找到的表示。 |
| `<T> ResponseEntity<T>`                    | `postForEntity(String url, Object request, Class<T> responseType, Map<String,?> uriVariables)`通过将给定对象发布到 URI 模板来创建新资源，并将响应返回为[`HttpEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/HttpEntity.html). |
| `<T> ResponseEntity<T>`                    | `postForEntity(String url, Object request, Class<T> responseType, Object... uriVariables)`通过将给定对象发布到 URI 模板来创建新资源，并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `<T> ResponseEntity<T>`                    | `postForEntity(URI url, Object request, Class<T> responseType)`通过将给定对象发布到 URL 来创建新资源，并将响应返回为[`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html). |
| `URI`                                      | `postForLocation(String url, Object request, Map<String,?> uriVariables)`通过将给定对象 POST 到 URI 模板来创建新资源，并返回`Location`标头的值。 |
| `URI`                                      | `postForLocation(String url, Object request, Object... uriVariables)`通过将给定对象 POST 到 URI 模板来创建新资源，并返回`Location`标头的值。 |
| `URI`                                      | `postForLocation(URI url, Object request)`通过将给定对象发布到 URL 来创建新资源，并返回 `Location`标头的值。 |
| `<T> T`                                    | `postForObject(String url, Object request, Class<T> responseType, Map<String,?> uriVariables)`通过将给定对象 POST 到 URI 模板来创建新资源，并返回在响应中找到的表示。 |
| `<T> T`                                    | `postForObject(String url, Object request, Class<T> responseType, Object... uriVariables)`通过将给定对象 POST 到 URI 模板来创建新资源，并返回在响应中找到的表示。 |
| `<T> T`                                    | `postForObject(URI url, Object request, Class<T> responseType)`通过将给定对象发布到 URL 来创建新资源，并返回在响应中找到的表示。 |
| `void`                                     | `put(String url, Object request, Map<String,?> uriVariables)`通过将给定对象 PUT 到 URI 模板来创建新资源。 |
| `void`                                     | `put(String url, Object request, Object... uriVariables)`通过将给定对象放入 URI 来创建或更新资源。 |
| `void`                                     | `put(URI url, Object request)`通过将给定对象放入 URL 来创建新资源。 |
| `<T> ResponseExtractor<ResponseEntity<T>>` | `responseEntityExtractor(Type responseType)`返回`ResponseExtractor`准备 a 的 a [`ResponseEntity`](https://docs.spring.io/spring-framework/docs/5.2.8.RELEASE/javadoc-api/org/springframework/http/ResponseEntity.html)。 |
| `void`                                     | `setDefaultUriVariables(Map<String,?> uriVars)`配置默认 URI 变量值。 |
| `void`                                     | `setErrorHandler(ResponseErrorHandler errorHandler)`设置错误处理程序。 |
| `void`                                     | `setMessageConverters(List<HttpMessageConverter<?>> messageConverters)`设置要使用的消息正文转换器。 |
| `void`                                     | `setUriTemplateHandler(UriTemplateHandler handler)`配置扩展 URI 模板的策略。 |



# 三, RestTemplate 之 Http Get 请求

RestTemplate 有两个核心方法来执行 Get 请求

1. getForObject 方法可以获取对象
2. getForEntity 方法不仅可以获取对象, 还可以获取 Http 状态码, 响应头等详细信息

## 3.1 getForObject 样例程序

````Java
// 实例化RestTemplate对象
RestTemplate restTemplate = new RestTemplate();

// 远程访问的url
String url = "https://baidu.com";

// 请求入参
Map<String, Long> paramMap = new HashMap<>();

// 远程调用
UserDTO result = restTemplate.getForObject(url, UserDTO.class, paramMap);
````



## 3.2 getForEntity 样例程序

````java
// 实例化RestTemplate对象
RestTemplate restTemplate = new RestTemplate();

// 远程访问的url
String url = "https://baidu.com";

// 请求入参
Map<String, Long> paramMap = new HashMap<>();

// 远程调用, ResponseEntity 包装返回结果
ResponseEntity<HashMap> responseEntity = restTemplate.getForEntity(url, HashMap.class, paramMap);

// 从返回结果获取状态码包装类
HttpStatus statusCode = responseEntity.getStatusCode();

// 从返回结果直接获取状态码
int statusCodeValue = responseEntity.getStatusCodeValue();

// 从返回结果获取响应体
HashMap resultMap = responseEntity.getBody();
````



# 四, RestTemplate 之 Http Post 请求

RestTemplate 有两个核心方法来执行 Post 请求

1. postForObject 方法可以获取对象
2. postForEntity 方法不仅可以获取对象, 还可以获取 Http 状态码, 响应头等详细信息

## 4.1 RestTemplate Post 和 Get 请求的区别

RestTemplate Post 和 Get 请求的区别是Post传参Map必须是MultiValueMap

Post方法的MultiValueMap即支持基本类型分开传参, 也支持实体传参



## 4.2 postForObject 样例程序

**基本类型传参和实体传参**

````Java
// 实例化RestTemplate对象
RestTemplate restTemplate = new RestTemplate();

// 远程访问的url
String url = "https://baidu.com";

// post方法必须使用 MultiValueMap 传参, 使用调用的url的入参类型对象传参也可以
MultiValueMap<String, Object> paramMap = new LinkedMultiValueMap<>();
paramMap.add("userId", 1000L);
paramMap.add("userName", "王大锤");

// 远程调用
UserDTO result = restTemplate.postForObject(url, paramMap, UserDTO.class);
````



**@RequestBody 传参, 需要使用HttpEntity形式传参**

````java
// 实例化RestTemplate对象
RestTemplate restTemplate = new RestTemplate();

// 声明一个请求头
HttpHeaders headers = new HttpHeaders();

// 设置 ContentType
// MediaType.APPLICATION_JSON_UTF8 等效于  httpPost.addHeader("Content-Type", "application/json;charset=utf-8"); 
headers.setContentType(MediaType.APPLICATION_JSON_UTF8);

// 远程访问的url
String url = "https://baidu.com";

/**
	此处使用 MultivalueMap 会报错
	MultiValueMap<String, Object> paramMap = new LinkedMultiValueMap<>();
	paramMap.add("userId", 1000L);
	paramMap.add("userName", "王大锤");
**/

// 此处可以使用HashMap代替, 但是会有警告
UserDTO userDTO = new UserDTO();
userDTO.setUserId(1000L);
userDTO.setUserName("王小锤");

// 使用Httpentity形式包装传参
HttpEntity<UserDTO> httpEntity = new HttpEntity<>(userDTO, headers);

// 远程调用
UserDTO result = restTemplate.postForObject(url, httpEntity, UserDTO.class);
````



## 4.3 postForEntity 样例程序

**postForEntity 和 postForObject 的唯一区别是返回的时候使用 ResponseEntity\<UserDTO\> , 其他一样**

*以下示例使用@RequestBody传参演示*

````java
// 实例化RestTemplate对象
RestTemplate restTemplate = new RestTemplate();

// 声明一个请求头
HttpHeaders headers = new HttpHeaders();

// 设置 ContentType
// MediaType.APPLICATION_JSON_UTF8 等效于  httpPost.addHeader("Content-Type", "application/json;charset=utf-8"); 
headers.setContentType(MediaType.APPLICATION_JSON_UTF8);

// 远程访问的url
String url = "https://baidu.com";

// 构建请求参数
UserDTO userDTO = new UserDTO();
userDTO.setUserId(1000L);
userDTO.setUserName("王小锤");

// 使用Httpentity形式包装传参
HttpEntity<UserDTO> httpEntity = new HttpEntity<>(userDTO, headers);

// 远程调用, ResponseEntity 包装返回结果
ResponseEntity<UserDTO> result = restTemplate.postForEntity(url, httpEntity, UserDTO.class);

// 从返回结果获取状态码包装类
HttpStatus statusCode = result.getStatusCode();

// 从返回结果直接获取状态码
int statusCodeValue = result.getStatusCodeValue();

// 从返回结果获取响应体
UserDTO resultMap = result.getBody();
````



# 五, RestTemplate 之 exchange 方法 

exchange 方法既可以发送Get请求, 也可以发送Post请求

exchange 方法既可以做getForEntity, 也可以做postForEntity

**exchange  使用时, 请求使用 HttpEntity, 返回使用 ResponseEntity**

````java
// 实例化RestTemplate对象
RestTemplate restTemplate = new RestTemplate();

// 声明一个请求头
HttpHeaders headers = new HttpHeaders();

// 设置 ContentType
// MediaType.APPLICATION_JSON_UTF8 等效于  httpPost.addHeader("Content-Type", "application/json;charset=utf-8"); 
headers.setContentType(MediaType.APPLICATION_JSON_UTF8);

// 远程访问的url
String url = "https://baidu.com";

// 构建请求参数
UserDTO userDTO = new UserDTO();
userDTO.setUserId(1000L);
userDTO.setUserName("王小锤");

// 使用Httpentity形式包装传参
HttpEntity<UserDTO> httpEntity = new HttpEntity<>(userDTO, headers);

// 远程调用, 指定请求方式, ResponseEntity 包装返回结果
ResponseEntity<UserDTO> result = restTemplate.exchange(url, HttpMethod.POST, httpEntity, UserDTO.class);

// 从返回结果获取状态码包装类
HttpStatus statusCode = result.getStatusCode();

// 从返回结果直接获取状态码
int statusCodeValue = result.getStatusCodeValue();

// 从返回结果获取响应体
UserDTO resultMap = result.getBody();
````









